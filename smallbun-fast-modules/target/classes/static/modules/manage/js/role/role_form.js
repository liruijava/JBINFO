function doSubmit(){var b=$(".form-horizontal").serializeArray();var f=$.ztree.getCheckedNodes("menuTree");var c=[];for(var e=0;e<f.length;e=e+1){c.push(f[e].id)}for(var e=0;e<c.length;e++){b.push({name:"menuList["+e+"].id",value:c[e]})}if($("#dataScope").select2("val")==="9"){var a=$.ztree.getCheckedNodes("orgTree");var d=[];for(var e=0;e<a.length;e=e+1){d.push(a[e].id)}for(var e=0;e<d.length;e++){b.push({name:"orgList["+e+"].id",value:d[e]})}}if($(".form-horizontal").valid()){$.operate.save($(".form-horizontal").attr("action"),b)}}$(".form-horizontal").validate({onkeyup:false,rules:{roleName:{required:true,remote:{async:false,url:contextPath+"role/unique",type:"post",dataType:"JSON",data:{id:function(){return $("#id").val()},roleName:function(){return $("#roleName").val()}},dataFilter:function(b,a){b=JSON.parse(b);return b.result}}},enName:{required:true,remote:{async:false,url:contextPath+"role/unique",type:"post",dataType:"JSON",data:{id:function(){return $("#id").val()},enName:function(){return $("#enName").val()}},dataFilter:function(b,a){b=JSON.parse(b);return b.result}}}},messages:{roleName:{required:"请输入角色名称",remote:"角色名称已存在"},enName:{remote:"角色编码已存在"}}});$("#menuCheckAllNodes").on("ifUnchecked",function(){$.ztree.checkAllFalse("menuTree")});$("#menuCheckAllNodes").on("ifChecked",function(){$.ztree.checkAllTrue("menuTree")});$("#orgCheckAllNodes").on("ifUnchecked",function(){$.ztree.checkAllFalse("orgTree")});$("#orgCheckAllNodes").on("ifChecked",function(){$.ztree.checkAllTrue("orgTree")});$("#dataScope").on("select2:select",function(a){if(a.params.data.id==="9"){$("#org-tree-div").slideDown("slow");loadOrgTree()}else{$("#org-tree-div").slideUp("slow")}});$(function(){loadMenuTree();if($("#dataScope").hasClass("select2-hidden-accessible")){if($("#dataScope").select2("val")==="9"){$("#org-tree-div").slideDown("slow");loadOrgTree()}else{$("#org-tree-div").slideUp("slow")}}});function loadMenuTree(){var a={view:{selectedMulti:false,showLine:true},check:{enable:true,chkboxType:{Y:"ps",N:"ps"}},data:{simpleData:{enable:true,idKey:"id",pIdKey:"parentId",rootPId:0},key:{name:"nodeName"}},callback:{onClick:function(b,d,c){}}};$.post(contextPath+"menu/list",function(e){var f=$.fn.zTree.init($("#menuTree"),a,e.result);f.expandAll(false);if($("#id").val()!==""&&$("#id").val()!==null&&$("#id").val()!==undefined){var d=JSON.parse($("#menusJson").val());for(var c=0;c<d.length;c++){var b=f.getNodesByParam("id",d[c].id,null);f.checkNode(b[0],true,false);f.expandNode(b[0],true,false)}}},null,null,"正在加载，请稍后...")}function loadOrgTree(){var a={view:{selectedMulti:false,showLine:true},check:{enable:true,chkboxType:{Y:"ps",N:"ps"}},data:{simpleData:{enable:true,idKey:"orgId",pIdKey:"parentId",rootPId:0},key:{name:"orgName"}},callback:{onClick:function(b,d,c){}}};$.post(contextPath+"org/list",function(f){var c=$.fn.zTree.init($("#orgTree"),a,f.result);c.expandAll(false);if($("#id").val()!==""&&$("#id").val()!==null&&$("#id").val()!==undefined){if($("#dataScope").select2("val")===$("#data-scope").val()){var e=JSON.parse($("#orgsJson").val());for(var d=0;d<e.length;d++){var b=c.getNodesByParam("orgId",e[d].id,null);c.checkNode(b[0],true,false);c.expandNode(b[0],true,false)}}}},null,null,"正在加载，请稍后...")};