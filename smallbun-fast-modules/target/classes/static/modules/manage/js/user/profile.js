function avatarSubmit(){$("#head-portrait-url").attr("src",$(".ng-scope.selected").find("img").attr("src"));$.ajax({url:contextPath+"user/updateHeadPortrait",type:"post",data:{id:$("#id").val(),url:$(".ng-scope.selected").find("img").attr("src")},dataType:"json",success:function(a){}})}function changPassword(){if($("#changPasswordForm").valid()){$.ajax({url:$("#changPasswordForm").attr("action"),type:"post",data:$("#changPasswordForm").serializeArray(),dataType:"json",success:function(a){if(a.status===web_status.SUCCESS){layer.confirm("修改成功, 请重新登录！",{icon:$.modal.icon(modal_status.SUCCESS),title:"系统提示",btn:["确认"],btnclass:["btn btn-primary"]},function(b){layer.close(b);document.location.href=contextPath+"logout"})}}})}}function updateUserInfo(){if($("#updateUserInfoForm").valid()){$.ajax({url:$("#updateUserInfoForm").attr("action"),type:"post",data:$("#updateUserInfoForm").serializeArray(),dataType:"json",success:function(a){if(a.status===web_status.SUCCESS){$.modal.alertSuccess("更新成功！")}}})}}$("#changPasswordForm").validate({onkeyup:false,rules:{oldPassword:{required:true,remote:{async:false,url:contextPath+"user/verifyOldPassword",type:"post",dataType:"JSON",data:{oldPassword:function(){return $("#oldPassword").val()}},dataFilter:function(b,a){b=JSON.parse(b);return b.result}}}},messages:{oldPassword:{remote:"原密码不正确"}}});$("#updateUserInfoForm").validate({onkeyup:false,rules:{email:{required:true,remote:{async:false,url:contextPath+"user/unique",type:"post",dataType:"JSON",data:{id:function(){return $("#id").val()},email:function(){return $("#email").val()}},dataFilter:function(b,a){b=JSON.parse(b);return b.result}}},phone:{isPhone:true,required:true,remote:{async:false,url:contextPath+"user/unique",type:"post",dataType:"JSON",data:{id:function(){return $("#id").val()},phone:function(){return $("#phone").val()}},dataFilter:function(b,a){b=JSON.parse(b);return b.result}}}},messages:{phone:{remote:"手机号已存在"},email:{remote:"邮箱已存在"}}});$(".ng-scope").click(function(a){$(".ng-scope").removeClass("selected");$(this).addClass("selected");$("#browse-img").attr("src",$(this).find("img").attr("src"))});