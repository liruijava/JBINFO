(function(c){var d=0;function b(i){var h=c.data(i,"filebox");var g=h.options;g.fileboxId="filebox_file_id_"+(++d);c(i).addClass("filebox-f").textbox(g);c(i).textbox("textbox").attr("readonly","readonly");h.filebox=c(i).next().addClass("filebox");var f=a(i);var e=c(i).filebox("button");if(e.length){c('<label class="filebox-label" for="'+g.fileboxId+'"></label>').appendTo(e);if(e.linkbutton("options").disabled){f._propAttr("disabled",true)}else{f._propAttr("disabled",false)}}}function a(e){var h=c.data(e,"filebox");var g=h.options;h.filebox.find(".textbox-value").remove();g.oldValue="";var f=c('<input type="file" class="textbox-value">').appendTo(h.filebox);f.attr("id",g.fileboxId).attr("name",c(e).attr("textboxName")||"");f.attr("accept",g.accept);f.attr("capture",g.capture);if(g.multiple){f.attr("multiple","multiple")}f.change(function(){var i=this.value;if(this.files){i=c.map(this.files,function(j){return j.name}).join(g.separator)}c(e).filebox("setText",i);g.onChange.call(e,i,g.oldValue);g.oldValue=i});return f}c.fn.filebox=function(g,f){if(typeof g=="string"){var e=c.fn.filebox.methods[g];if(e){return e(this,f)}else{return this.textbox(g,f)}}g=g||{};return this.each(function(){var h=c.data(this,"filebox");if(h){c.extend(h.options,g)}else{c.data(this,"filebox",{options:c.extend({},c.fn.filebox.defaults,c.fn.filebox.parseOptions(this),g)})}b(this)})};c.fn.filebox.methods={options:function(f){var e=f.textbox("options");return c.extend(c.data(f[0],"filebox").options,{width:e.width,value:e.value,originalValue:e.originalValue,disabled:e.disabled,readonly:e.readonly})},clear:function(e){return e.each(function(){c(this).textbox("clear");a(this)})},reset:function(e){return e.each(function(){c(this).filebox("clear")})},setValue:function(e){return e},setValues:function(e){return e},files:function(e){return e.next().find(".textbox-value")[0].files}};c.fn.filebox.parseOptions=function(f){var e=c(f);return c.extend({},c.fn.textbox.parseOptions(f),c.parser.parseOptions(f,["accept","capture","separator"]),{multiple:(e.attr("multiple")?true:undefined)})};c.fn.filebox.defaults=c.extend({},c.fn.textbox.defaults,{buttonIcon:null,buttonText:"Choose File",buttonAlign:"right",inputEvents:{},accept:"",capture:"",separator:",",multiple:false})})(jQuery);