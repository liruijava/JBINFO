(function(d){var j=1;function h(m){d(m).addClass("sidemenu")}function g(o,n){var m=d(o).sidemenu("options");if(n){d.extend(m,{width:n.width,height:n.height})}d(o)._size(m);d(o).find(".accordion").accordion("resize")}function f(m,p,o){var n=d(m).sidemenu("options");var q=d('<ul class="sidemenu-tree"></ul>').appendTo(p);q.tree({data:o,animate:n.animate,onBeforeSelect:function(r){if(r.children){return false}},onSelect:function(r){c(m,r.id,true)},onExpand:function(r){k(m,r)},onCollapse:function(r){k(m,r)},onClick:function(r){if(r.children){if(r.state=="open"){d(r.target).addClass("tree-node-nonleaf-collapsed")}else{d(r.target).removeClass("tree-node-nonleaf-collapsed")}d(this).tree("toggle",r.target)}}});q.unbind(".sidemenu").bind("mouseleave.sidemenu",function(){d(p).trigger("mouseleave")});c(m,n.selectedItemId)}function b(p,o,n){var m=d(p).sidemenu("options");d(o).tooltip({content:d("<div></div>"),position:m.floatMenuPosition,valign:"top",data:n,onUpdate:function(r){var q=d(this).tooltip("options");var s=q.data;r.accordion({width:m.floatMenuWidth,multiple:false}).accordion("add",{title:s.text,collapsed:false,collapsible:false});f(p,r.accordion("panels")[0],s.children)},onShow:function(){var q=d(this);var r=q.tooltip("tip").addClass("sidemenu-tooltip");r.children(".tooltip-content").addClass("sidemenu");r.find(".accordion").accordion("resize");r.add(r.find("ul.tree")).unbind(".sidemenu").bind("mouseover.sidemenu",function(){q.tooltip("show")}).bind("mouseleave.sidemenu",function(){q.tooltip("hide")});q.tooltip("reposition")},onPosition:function(q,s){var r=d(this).tooltip("tip");if(!m.collapsed){r.css({left:-999999})}else{if(s+r.outerHeight()>d(window)._outerHeight()+d(document).scrollTop()){s=d(window)._outerHeight()+d(document).scrollTop()-r.outerHeight();r.css("top",s)}}}})}function a(n,m){d(n).find(".sidemenu-tree").each(function(){m(d(this))});d(n).find(".tooltip-f").each(function(){var o=d(this).tooltip("tip");if(o){o.find(".sidemenu-tree").each(function(){m(d(this))});d(this).tooltip("reposition")}})}function c(n,o,m){var q=null;var p=d(n).sidemenu("options");a(n,function(r){r.find("div.tree-node-selected").removeClass("tree-node-selected");var s=r.tree("find",o);if(s){d(s.target).addClass("tree-node-selected");p.selectedItemId=s.id;r.trigger("mouseleave.sidemenu");q=s}});if(m&&q){p.onSelect.call(n,q)}}function k(n,m){a(n,function(q){var p=q.tree("find",m.id);if(p){var o=q.tree("options");var r=o.animate;o.animate=false;q.tree(m.state=="open"?"expand":"collapse",p.target);o.animate=r}})}function l(q){var p=d(q).sidemenu("options");d(q).empty();if(p.data){d.easyui.forEach(p.data,true,function(s){if(!s.id){s.id="_easyui_sidemenu_"+(j++)}if(!s.iconCls){s.iconCls="sidemenu-default-icon"}if(s.children){s.nodeCls="tree-node-nonleaf";if(!s.state){s.state="closed"}if(s.state=="open"){s.nodeCls="tree-node-nonleaf"}else{s.nodeCls="tree-node-nonleaf tree-node-nonleaf-collapsed"}}});var r=d("<div></div>").appendTo(q);r.accordion({fit:p.height=="auto"?false:true,border:p.border,multiple:p.multiple});var m=p.data;for(var o=0;o<m.length;o++){r.accordion("add",{title:m[o].text,selected:m[o].state=="open",iconCls:m[o].iconCls,onBeforeExpand:function(){return !p.collapsed}});var n=r.accordion("panels")[o];f(q,n,m[o].children);b(q,n.panel("header"),m[o])}}}function i(o,n){var m=d(o).sidemenu("options");m.collapsed=n;var q=d(o).find(".accordion");var t=q.accordion("panels");q.accordion("options").animate=false;if(m.collapsed){d(o).addClass("sidemenu-collapsed");for(var p=0;p<t.length;p++){var s=t[p];if(s.panel("options").collapsed){m.data[p].state="closed"}else{m.data[p].state="open";q.accordion("unselect",p)}var r=s.panel("header");r.find(".panel-title").html("");r.find(".panel-tool").hide()}}else{d(o).removeClass("sidemenu-collapsed");for(var p=0;p<t.length;p++){var s=t[p];if(m.data[p].state=="open"){q.accordion("select",p)}var r=s.panel("header");r.find(".panel-title").html(s.panel("options").title);r.find(".panel-tool").show()}}q.accordion("options").animate=m.animate}function e(m){d(m).find(".tooltip-f").each(function(){d(this).tooltip("destroy")});d(m).remove()}d.fn.sidemenu=function(m,o){if(typeof m=="string"){var n=d.fn.sidemenu.methods[m];return n(this,o)}m=m||{};return this.each(function(){var p=d.data(this,"sidemenu");if(p){d.extend(p.options,m)}else{p=d.data(this,"sidemenu",{options:d.extend({},d.fn.sidemenu.defaults,d.fn.sidemenu.parseOptions(this),m)});h(this)}g(this);l(this);i(this,p.options.collapsed)})};d.fn.sidemenu.methods={options:function(m){return m.data("sidemenu").options},resize:function(n,m){return n.each(function(){g(this,m)})},collapse:function(m){return m.each(function(){i(this,true)})},expand:function(m){return m.each(function(){i(this,false)})},destroy:function(m){return m.each(function(){e(this)})}};d.fn.sidemenu.parseOptions=function(n){var m=d(n);return d.extend({},d.parser.parseOptions(n,["width","height"]))};d.fn.sidemenu.defaults={width:200,height:"auto",border:true,animate:true,multiple:true,collapsed:false,data:null,floatMenuWidth:200,floatMenuPosition:"right",onSelect:function(m){}}})(jQuery);