(function(e){function f(){e(document).unbind(".messager").bind("keydown.messager",function(m){if(m.keyCode==27){e("body").children("div.messager-window").children("div.messager-body").each(function(){e(this).dialog("close")})}else{if(m.keyCode==9){var l=e("body").children("div.messager-window");if(!l.length){return}var k=l.find(".messager-input,.messager-button .l-btn");for(var h=0;h<k.length;h++){if(e(k[h]).is(":focus")){e(k[h>=k.length-1?0:h+1]).focus();return false}}}else{if(m.keyCode==13){var j=e(m.target).closest("input.messager-input");if(j.length){var g=j.closest(".messager-body");d(g,j.val())}}}}})}function c(){e(document).unbind(".messager")}function b(g){var i=e.extend({},e.messager.defaults,{modal:false,shadow:false,draggable:false,resizable:false,closed:true,style:{left:"",top:"",right:0,zIndex:e.fn.window.defaults.zIndex++,bottom:-document.body.scrollTop-document.documentElement.scrollTop},title:"",width:300,height:150,minHeight:0,showType:"slide",showSpeed:600,content:g.msg,timeout:4000},g);var h=e('<div class="messager-body"></div>').appendTo("body");h.dialog(e.extend({},i,{noheader:(i.title?false:true),openAnimation:(i.showType),closeAnimation:(i.showType=="show"?"hide":i.showType),openDuration:i.showSpeed,closeDuration:i.showSpeed,onOpen:function(){h.dialog("dialog").hover(function(){if(i.timer){clearTimeout(i.timer)}},function(){j()});j();function j(){if(i.timeout>0){i.timer=setTimeout(function(){if(h.length&&h.data("dialog")){h.dialog("close")}},i.timeout)}}if(g.onOpen){g.onOpen.call(this)}else{i.onOpen.call(this)}},onClose:function(){if(i.timer){clearTimeout(i.timer)}if(g.onClose){g.onClose.call(this)}else{i.onClose.call(this)}h.dialog("destroy")}}));h.dialog("dialog").css(i.style);h.dialog("open");return h}function a(g){f();var i=e('<div class="messager-body"></div>').appendTo("body");i.dialog(e.extend({},g,{noheader:(g.title?false:true),onClose:function(){c();if(g.onClose){g.onClose.call(this)}i.dialog("destroy")}}));var h=i.dialog("dialog").addClass("messager-window");h.find(".dialog-button").addClass("messager-button").find("a:first").focus();return i}function d(h,i){var g=h.dialog("options");h.dialog("close");g.fn(i)}e.messager={show:function(g){return b(g)},alert:function(k,m,j,i){var h=typeof k=="object"?k:{title:k,msg:m,icon:j,fn:i};var g=h.icon?"messager-icon messager-"+h.icon:"";h=e.extend({},e.messager.defaults,{content:'<div class="'+g+'"></div><div>'+h.msg+'</div><div style="clear:both;"/>'},h);if(!h.buttons){h.buttons=[{text:h.ok,onClick:function(){d(l)}}]}var l=a(h);return l},confirm:function(h,k,i){var g=typeof h=="object"?h:{title:h,msg:k,fn:i};g=e.extend({},e.messager.defaults,{content:'<div class="messager-icon messager-question"></div><div>'+g.msg+'</div><div style="clear:both;"/>'},g);if(!g.buttons){g.buttons=[{text:g.ok,onClick:function(){d(j,true)}},{text:g.cancel,onClick:function(){d(j,false)}}]}var j=a(g);return j},prompt:function(h,k,i){var g=typeof h=="object"?h:{title:h,msg:k,fn:i};g=e.extend({},e.messager.defaults,{content:'<div class="messager-icon messager-question"></div><div>'+g.msg+'</div><br/><div style="clear:both;"/><div><input class="messager-input" type="text"/></div>'},g);if(!g.buttons){g.buttons=[{text:g.ok,onClick:function(){d(j,j.find(".messager-input").val())}},{text:g.cancel,onClick:function(){d(j)}}]}var j=a(g);j.find(".messager-input").focus();return j},progress:function(j){var i={bar:function(){return e("body>div.messager-window").find("div.messager-p-bar")},close:function(){var m=e("body>div.messager-window>div.messager-body:has(div.messager-progress)");if(m.length){m.dialog("close")}}};if(typeof j=="string"){var h=i[j];return h()}j=j||{};var g=e.extend({},{title:"",minHeight:0,content:undefined,msg:"",text:undefined,interval:300},j);var l=a(e.extend({},e.messager.defaults,{content:'<div class="messager-progress"><div class="messager-p-msg">'+g.msg+'</div><div class="messager-p-bar"></div></div>',closable:false,doSize:false},g,{onClose:function(){if(this.timer){clearInterval(this.timer)}if(j.onClose){j.onClose.call(this)}else{e.messager.defaults.onClose.call(this)}}}));var k=l.find("div.messager-p-bar");k.progressbar({text:g.text});l.dialog("resize");if(g.interval){l[0].timer=setInterval(function(){var m=k.progressbar("getValue");m+=10;if(m>100){m=0}k.progressbar("setValue",m)},g.interval)}return l}};e.messager.defaults=e.extend({},e.fn.dialog.defaults,{ok:"Ok",cancel:"Cancel",width:300,height:"auto",minHeight:150,modal:true,collapsible:false,minimizable:false,maximizable:false,resizable:false,fn:function(){}})})(jQuery);