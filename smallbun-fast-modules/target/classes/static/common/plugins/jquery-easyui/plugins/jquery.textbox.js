(function(b){var i=0;function h(m){b(m).addClass("textbox-f").hide();var l=b('<span class="textbox"><input class="textbox-text" autocomplete="off"><input type="hidden" class="textbox-value"></span>').insertAfter(m);var k=b(m).attr("name");if(k){l.find("input.textbox-value").attr("name",k);b(m).removeAttr("name").attr("textboxName",k)}return l}function f(o){var n=b.data(o,"textbox");var m=n.options;var k=n.textbox;var s="_easyui_textbox_input"+(++i);k.addClass(m.cls);k.find(".textbox-text").remove();if(m.multiline){b('<textarea id="'+s+'" class="textbox-text" autocomplete="off"></textarea>').prependTo(k)}else{b('<input id="'+s+'" type="'+m.type+'" class="textbox-text" autocomplete="off">').prependTo(k)}b("#"+s).attr("tabindex",b(o).attr("tabindex")||"").css("text-align",o.style.textAlign||"");k.find(".textbox-addon").remove();var q=m.icons?b.extend(true,[],m.icons):[];if(m.iconCls){q.push({iconCls:m.iconCls,disabled:true})}if(q.length){var p=b('<span class="textbox-addon"></span>').prependTo(k);p.addClass("textbox-addon-"+m.iconAlign);for(var l=0;l<q.length;l++){p.append('<a href="javascript:;" class="textbox-icon '+q[l].iconCls+'" icon-index="'+l+'" tabindex="-1"></a>')}}k.find(".textbox-button").remove();if(m.buttonText||m.buttonIcon){var r=b('<a href="javascript:;" class="textbox-button"></a>').prependTo(k);r.addClass("textbox-button-"+m.buttonAlign).linkbutton({text:m.buttonText,iconCls:m.buttonIcon,onClick:function(){var u=b(this).parent().prev();u.textbox("options").onClickButton.call(u[0])}})}if(m.label){if(typeof m.label=="object"){n.label=b(m.label);n.label.attr("for",s)}else{b(n.label).remove();n.label=b('<label class="textbox-label"></label>').html(m.label);n.label.css("textAlign",m.labelAlign).attr("for",s);if(m.labelPosition=="after"){n.label.insertAfter(k)}else{n.label.insertBefore(o)}n.label.removeClass("textbox-label-left textbox-label-right textbox-label-top");n.label.addClass("textbox-label-"+m.labelPosition)}}else{b(n.label).remove()}g(o);e(o,m.disabled);d(o,m.readonly)}function c(m){var l=b.data(m,"textbox");var k=l.textbox;k.find(".textbox-text").validatebox("destroy");k.remove();b(l.label).remove();b(m).remove()}function a(x,v){var t=b.data(x,"textbox");var r=t.options;var y=t.textbox;var p=y.parent();if(v){if(typeof v=="object"){b.extend(r,v)}else{r.width=v}}if(isNaN(parseInt(r.width))){var z=b(x).clone();z.css("visibility","hidden");z.insertAfter(x);r.width=z.outerWidth();z.remove()}var n=y.is(":visible");if(!n){y.appendTo("body")}var k=y.find(".textbox-text");var m=y.find(".textbox-button");var w=y.find(".textbox-addon");var u=w.find(".textbox-icon");if(r.height=="auto"){k.css({margin:"",paddingTop:"",paddingBottom:"",height:"",lineHeight:""})}y._size(r,p);if(r.label&&r.labelPosition){if(r.labelPosition=="top"){t.label._size({width:r.labelWidth=="auto"?y.outerWidth():r.labelWidth},y);if(r.height!="auto"){y._size("height",y.outerHeight()-t.label.outerHeight())}}else{t.label._size({width:r.labelWidth,height:y.outerHeight()},y);if(!r.multiline){t.label.css("lineHeight",t.label.height()+"px")}y._size("width",y.outerWidth()-t.label.outerWidth())}}if(r.buttonAlign=="left"||r.buttonAlign=="right"){m.linkbutton("resize",{height:y.height()})}else{m.linkbutton("resize",{width:"100%"})}var s=y.width()-u.length*r.iconWidth-q("left")-q("right");var o=r.height=="auto"?k.outerHeight():(y.height()-q("top")-q("bottom"));w.css(r.iconAlign,q(r.iconAlign)+"px");w.css("top",q("top")+"px");u.css({width:r.iconWidth+"px",height:o+"px"});k.css({paddingLeft:(x.style.paddingLeft||""),paddingRight:(x.style.paddingRight||""),marginLeft:l("left"),marginRight:l("right"),marginTop:q("top"),marginBottom:q("bottom")});if(r.multiline){k.css({paddingTop:(x.style.paddingTop||""),paddingBottom:(x.style.paddingBottom||"")});k._outerHeight(o)}else{k.css({paddingTop:0,paddingBottom:0,height:o+"px",lineHeight:o+"px"})}k._outerWidth(s);r.onResizing.call(x,r.width,r.height);if(!n){y.insertAfter(x)}r.onResize.call(x,r.width,r.height);function l(A){return(r.iconAlign==A?w._outerWidth():0)+q(A)}function q(A){var B=0;m.filter(".textbox-button-"+A).each(function(){if(A=="left"||A=="right"){B+=b(this).outerWidth()}else{B+=b(this).outerHeight()}});return B}}function g(m){var l=b(m).textbox("options");var k=b(m).textbox("textbox");k.validatebox(b.extend({},l,{deltaX:function(n){return b(m).textbox("getTipX",n)},deltaY:function(n){return b(m).textbox("getTipY",n)},onBeforeValidate:function(){l.onBeforeValidate.call(m);var n=b(this);if(!n.is(":focus")){if(n.val()!==l.value){l.oldInputValue=n.val();n.val(l.value)}}},onValidate:function(o){var p=b(this);if(l.oldInputValue!=undefined){p.val(l.oldInputValue);l.oldInputValue=undefined}var n=p.parent();if(o){n.removeClass("textbox-invalid")}else{n.addClass("textbox-invalid")}l.onValidate.call(m,o)}}))}function j(m){var r=b.data(m,"textbox");var q=r.options;var k=r.textbox;var p=k.find(".textbox-text");p.attr("placeholder",q.prompt);p.unbind(".textbox");b(r.label).unbind(".textbox");if(!q.disabled&&!q.readonly){if(r.label){b(r.label).bind("click.textbox",function(s){if(!q.hasFocusMe){p.focus();b(m).textbox("setSelectionRange",{start:0,end:p.val().length})}})}p.bind("blur.textbox",function(s){if(!k.hasClass("textbox-focused")){return}q.value=b(this).val();if(q.value==""){b(this).val(q.prompt).addClass("textbox-prompt")}else{b(this).removeClass("textbox-prompt")}k.removeClass("textbox-focused");k.closest(".form-field").removeClass("form-field-focused")}).bind("focus.textbox",function(s){q.hasFocusMe=true;if(k.hasClass("textbox-focused")){return}if(b(this).val()!=q.value){b(this).val(q.value)}b(this).removeClass("textbox-prompt");k.addClass("textbox-focused");k.closest(".form-field").addClass("form-field-focused")});for(var o in q.inputEvents){p.bind(o+".textbox",{target:m},q.inputEvents[o])}}var l=k.find(".textbox-addon");l.unbind().bind("click",{target:m},function(v){var t=b(v.target).closest("a.textbox-icon:not(.textbox-icon-disabled)");if(t.length){var u=parseInt(t.attr("icon-index"));var s=q.icons[u];if(s&&s.handler){s.handler.call(t[0],v)}q.onClickIcon.call(m,u)}});l.find(".textbox-icon").each(function(t){var s=q.icons[t];var u=b(this);if(!s||s.disabled||q.disabled||q.readonly){u.addClass("textbox-icon-disabled")}else{u.removeClass("textbox-icon-disabled")}});var n=k.find(".textbox-button");n.linkbutton((q.disabled||q.readonly)?"disable":"enable");k.unbind(".textbox").bind("_resize.textbox",function(s,t){if(b(this).hasClass("easyui-fluid")||t){a(m)}return false})}function e(p,o){var n=b.data(p,"textbox");var m=n.options;var k=n.textbox;var q=k.find(".textbox-text");var l=b(p).add(k.find(".textbox-value"));m.disabled=o;if(m.disabled){q.blur();q.validatebox("disable");k.addClass("textbox-disabled");l._propAttr("disabled",true);b(n.label).addClass("textbox-label-disabled")}else{q.validatebox("enable");k.removeClass("textbox-disabled");l._propAttr("disabled",false);b(n.label).removeClass("textbox-label-disabled")}}function d(p,o){var n=b.data(p,"textbox");var m=n.options;var k=n.textbox;var l=k.find(".textbox-text");m.readonly=o==undefined?true:o;if(m.readonly){l.triggerHandler("blur.textbox")}l.validatebox("readonly",m.readonly);k.removeClass("textbox-readonly").addClass(m.readonly?"textbox-readonly":"")}b.fn.textbox=function(m,l){if(typeof m=="string"){var k=b.fn.textbox.methods[m];if(k){return k(this,l)}else{return this.each(function(){var n=b(this).textbox("textbox");n.validatebox(m,l)})}}m=m||{};return this.each(function(){var o=b.data(this,"textbox");if(o){b.extend(o.options,m);if(m.value!=undefined){o.options.originalValue=m.value}}else{o=b.data(this,"textbox",{options:b.extend({},b.fn.textbox.defaults,b.fn.textbox.parseOptions(this),m),textbox:h(this)});o.options.originalValue=o.options.value}f(this);j(this);if(o.options.doSize){a(this)}var n=o.options.value;o.options.value="";b(this).textbox("initValue",n)})};b.fn.textbox.methods={options:function(k){return b.data(k[0],"textbox").options},cloneFrom:function(l,k){return l.each(function(){var n=b(this);if(n.data("textbox")){return}if(!b(k).data("textbox")){b(k).textbox()}var r=b.extend(true,{},b(k).textbox("options"));var p=n.attr("name")||"";n.addClass("textbox-f").hide();n.removeAttr("name").attr("textboxName",p);var o=b(k).next().clone().insertAfter(n);var m="_easyui_textbox_input"+(++i);o.find(".textbox-value").attr("name",p);o.find(".textbox-text").attr("id",m);var s=b(b(k).textbox("label")).clone();if(s.length){s.attr("for",m);if(r.labelPosition=="after"){s.insertAfter(n.next())}else{s.insertBefore(n)}}b.data(this,"textbox",{options:r,textbox:o,label:(s.length?s:undefined)});var q=b(k).textbox("button");if(q.length){n.textbox("button").linkbutton(b.extend(true,{},q.linkbutton("options")))}j(this);g(this)})},textbox:function(k){return b.data(k[0],"textbox").textbox.find(".textbox-text")},button:function(k){return b.data(k[0],"textbox").textbox.find(".textbox-button")},label:function(k){return b.data(k[0],"textbox").label},destroy:function(k){return k.each(function(){c(this)})},resize:function(l,k){return l.each(function(){a(this,k)})},disable:function(k){return k.each(function(){e(this,true);j(this)})},enable:function(k){return k.each(function(){e(this,false);j(this)})},readonly:function(l,k){return l.each(function(){d(this,k);j(this)})},isValid:function(k){return k.textbox("textbox").validatebox("isValid")},clear:function(k){return k.each(function(){b(this).textbox("setValue","")})},setText:function(l,k){return l.each(function(){var n=b(this).textbox("options");var m=b(this).textbox("textbox");k=k==undefined?"":String(k);if(b(this).textbox("getText")!=k){m.val(k)}n.value=k;if(!m.is(":focus")){if(k){m.removeClass("textbox-prompt")}else{m.val(n.prompt).addClass("textbox-prompt")}}if(n.value){b(this).closest(".form-field").removeClass("form-field-empty")}else{b(this).closest(".form-field").addClass("form-field-empty")}b(this).textbox("validate")})},initValue:function(l,k){return l.each(function(){var m=b.data(this,"textbox");b(this).textbox("setText",k);m.textbox.find(".textbox-value").val(k);b(this).val(k)})},setValue:function(l,k){return l.each(function(){var n=b.data(this,"textbox").options;var m=b(this).textbox("getValue");b(this).textbox("initValue",k);if(m!=k){n.onChange.call(this,k,m);b(this).closest("form").trigger("_change",[this])}})},getText:function(l){var k=l.textbox("textbox");if(k.is(":focus")){return k.val()}else{return l.textbox("options").value}},getValue:function(k){return k.data("textbox").textbox.find(".textbox-value").val()},reset:function(k){return k.each(function(){var l=b(this).textbox("options");b(this).textbox("textbox").val(l.originalValue);b(this).textbox("setValue",l.originalValue)})},getIcon:function(l,k){return l.data("textbox").textbox.find(".textbox-icon:eq("+k+")")},getTipX:function(k,t){var s=k.data("textbox");var r=s.options;var l=s.textbox;var o=l.find(".textbox-text");var t=t||r.tipPosition;var q=l.offset();var p=o.offset();var n=l.outerWidth();var m=o.outerWidth();if(t=="right"){return n-m-p.left+q.left}else{if(t=="left"){return q.left-p.left}else{return(n-m-p.left+q.left)/2-(p.left-q.left)/2}}},getTipY:function(k,r){var q=k.data("textbox");var p=q.options;var l=q.textbox;var o=l.find(".textbox-text");var r=r||p.tipPosition;var t=l.offset();var s=o.offset();var n=l.outerHeight();var m=o.outerHeight();if(r=="left"||r=="right"){return(n-m-s.top+t.top)/2-(s.top-t.top)/2}else{if(r=="bottom"){return(n-m-s.top+t.top)}else{return(t.top-s.top)}}},getSelectionStart:function(k){return k.textbox("getSelectionRange").start},getSelectionRange:function(p){var o=p.textbox("textbox")[0];var n=0;var k=0;if(typeof o.selectionStart=="number"){n=o.selectionStart;k=o.selectionEnd}else{if(o.createTextRange){var m=document.selection.createRange();var l=o.createTextRange();l.setEndPoint("EndToStart",m);n=l.text.length;k=n+m.text.length}}return{start:n,end:k}},setSelectionRange:function(l,k){return l.each(function(){var p=b(this).textbox("textbox")[0];var o=k.start;var n=k.end;if(p.setSelectionRange){p.setSelectionRange(o,n)}else{if(p.createTextRange){var m=p.createTextRange();m.collapse();m.moveEnd("character",n);m.moveStart("character",o);m.select()}}})}};b.fn.textbox.parseOptions=function(k){var l=b(k);return b.extend({},b.fn.validatebox.parseOptions(k),b.parser.parseOptions(k,["prompt","iconCls","iconAlign","buttonText","buttonIcon","buttonAlign","label","labelPosition","labelAlign",{multiline:"boolean",iconWidth:"number",labelWidth:"number"}]),{value:(l.val()||undefined),type:(l.attr("type")?l.attr("type"):undefined)})};b.fn.textbox.defaults=b.extend({},b.fn.validatebox.defaults,{doSize:true,width:"auto",height:"auto",cls:null,prompt:"",value:"",type:"text",multiline:false,icons:[],iconCls:null,iconAlign:"right",iconWidth:26,buttonText:"",buttonIcon:null,buttonAlign:"right",label:null,labelWidth:"auto",labelPosition:"before",labelAlign:"left",inputEvents:{blur:function(m){var l=b(m.data.target);var k=l.textbox("options");if(l.textbox("getValue")!=k.value){l.textbox("setValue",k.value)}},keydown:function(l){if(l.keyCode==13){var k=b(l.data.target);k.textbox("setValue",k.textbox("getText"))}}},onChange:function(l,k){},onResizing:function(l,k){},onResize:function(l,k){},onClickButton:function(){},onClickIcon:function(k){}})})(jQuery);