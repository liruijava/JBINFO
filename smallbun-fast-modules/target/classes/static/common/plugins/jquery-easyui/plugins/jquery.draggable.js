(function(e){function g(n){var m=e.data(n.data.target,"draggable");var l=m.options;var k=m.proxy;var j=n.data;var i=j.startLeft+n.pageX-j.startX;var h=j.startTop+n.pageY-j.startY;if(k){if(k.parent()[0]==document.body){if(l.deltaX!=null&&l.deltaX!=undefined){i=n.pageX+l.deltaX}else{i=n.pageX-n.data.offsetWidth}if(l.deltaY!=null&&l.deltaY!=undefined){h=n.pageY+l.deltaY}else{h=n.pageY-n.data.offsetHeight}}else{if(l.deltaX!=null&&l.deltaX!=undefined){i+=n.data.offsetWidth+l.deltaX}if(l.deltaY!=null&&l.deltaY!=undefined){h+=n.data.offsetHeight+l.deltaY}}}if(n.data.parent!=document.body){i+=e(n.data.parent).scrollLeft();h+=e(n.data.parent).scrollTop()}if(l.axis=="h"){j.left=i}else{if(l.axis=="v"){j.top=h}else{j.left=i;j.top=h}}}function a(k){var h=e.data(k.data.target,"draggable");var j=h.options;var i=h.proxy;if(!i){i=e(k.data.target)}i.css({left:k.data.left,top:k.data.top});e("body").css("cursor",j.cursor)}function b(j){if(!e.fn.draggable.isDragging){return false}var i=e.data(j.data.target,"draggable");var h=i.options;var l=e(".droppable:visible").filter(function(){return j.data.target!=this}).filter(function(){var m=e.data(this,"droppable").options.accept;if(m){return e(m).filter(function(){return this==j.data.target}).length>0}else{return true}});i.droppables=l;var k=i.proxy;if(!k){if(h.proxy){if(h.proxy=="clone"){k=e(j.data.target).clone().insertAfter(j.data.target)}else{k=h.proxy.call(j.data.target,j.data.target)}i.proxy=k}else{k=e(j.data.target)}}k.css("position","absolute");g(j);a(j);h.onStartDrag.call(j.data.target,j);return false}function f(j){if(!e.fn.draggable.isDragging){return false}var i=e.data(j.data.target,"draggable");g(j);if(i.options.onDrag.call(j.data.target,j)!=false){a(j)}var h=j.data.target;i.droppables.each(function(){var k=e(this);if(k.droppable("options").disabled){return}var l=k.offset();if(j.pageX>l.left&&j.pageX<l.left+k.outerWidth()&&j.pageY>l.top&&j.pageY<l.top+k.outerHeight()){if(!this.entered){e(this).trigger("_dragenter",[h]);this.entered=true}e(this).trigger("_dragover",[h])}else{if(this.entered){e(this).trigger("_dragleave",[h]);this.entered=false}}});return false}function d(o){if(!e.fn.draggable.isDragging){c();return false}f(o);var j=e.data(o.data.target,"draggable");var h=j.proxy;var m=j.options;m.onEndDrag.call(o.data.target,o);if(m.revert){if(l()==true){e(o.data.target).css({position:o.data.startPosition,left:o.data.startLeft,top:o.data.startTop})}else{if(h){var k,n;if(h.parent()[0]==document.body){k=o.data.startX-o.data.offsetWidth;n=o.data.startY-o.data.offsetHeight}else{k=o.data.startLeft;n=o.data.startTop}h.animate({left:k,top:n},function(){i()})}else{e(o.data.target).animate({left:o.data.startLeft,top:o.data.startTop},function(){e(o.data.target).css("position",o.data.startPosition)})}}}else{e(o.data.target).css({position:"absolute",left:o.data.left,top:o.data.top});l()}m.onStopDrag.call(o.data.target,o);c();function i(){if(h){h.remove()}j.proxy=null}function l(){var p=false;j.droppables.each(function(){var q=e(this);if(q.droppable("options").disabled){return}var r=q.offset();if(o.pageX>r.left&&o.pageX<r.left+q.outerWidth()&&o.pageY>r.top&&o.pageY<r.top+q.outerHeight()){if(m.revert){e(o.data.target).css({position:o.data.startPosition,left:o.data.startLeft,top:o.data.startTop})}e(this).triggerHandler("_drop",[o.data.target]);i();p=true;this.entered=false;return false}});if(!p&&!m.revert){i()}return p}return false}function c(){if(e.fn.draggable.timer){clearTimeout(e.fn.draggable.timer);e.fn.draggable.timer=undefined}e(document).unbind(".draggable");e.fn.draggable.isDragging=false;setTimeout(function(){e("body").css("cursor","")},100)}e.fn.draggable=function(i,h){if(typeof i=="string"){return e.fn.draggable.methods[i](this,h)}return this.each(function(){var m;var l=e.data(this,"draggable");if(l){l.handle.unbind(".draggable");m=e.extend(l.options,i)}else{m=e.extend({},e.fn.draggable.defaults,e.fn.draggable.parseOptions(this),i||{})}var k=m.handle?(typeof m.handle=="string"?e(m.handle,this):m.handle):e(this);e.data(this,"draggable",{options:m,handle:k});if(m.disabled){e(this).css("cursor","");return}k.unbind(".draggable").bind("mousemove.draggable",{target:this},function(o){if(e.fn.draggable.isDragging){return}var n=e.data(o.data.target,"draggable").options;if(j(o)){e(this).css("cursor",n.cursor)}else{e(this).css("cursor","")}}).bind("mouseleave.draggable",{target:this},function(n){e(this).css("cursor","")}).bind("mousedown.draggable",{target:this},function(r){if(j(r)==false){return}e(this).css("cursor","");var p=e(r.data.target).position();var o=e(r.data.target).offset();var n={startPosition:e(r.data.target).css("position"),startLeft:p.left,startTop:p.top,left:p.left,top:p.top,startX:r.pageX,startY:r.pageY,width:e(r.data.target).outerWidth(),height:e(r.data.target).outerHeight(),offsetWidth:(r.pageX-o.left),offsetHeight:(r.pageY-o.top),target:r.data.target,parent:e(r.data.target).parent()[0]};e.extend(r.data,n);var q=e.data(r.data.target,"draggable").options;if(q.onBeforeDrag.call(r.data.target,r)==false){return}e(document).bind("mousedown.draggable",r.data,b);e(document).bind("mousemove.draggable",r.data,f);e(document).bind("mouseup.draggable",r.data,d);e.fn.draggable.timer=setTimeout(function(){e.fn.draggable.isDragging=true;b(r)},q.delay);return false});function j(p){var y=e.data(p.data.target,"draggable");var w=y.handle;var v=e(w).offset();var u=e(w).outerWidth();var s=e(w).outerHeight();var x=p.pageY-v.top;var n=v.left+u-p.pageX;var q=v.top+s-p.pageY;var o=p.pageX-v.left;return Math.min(x,n,q,o)>y.options.edge}})};e.fn.draggable.methods={options:function(h){return e.data(h[0],"draggable").options},proxy:function(h){return e.data(h[0],"draggable").proxy},enable:function(h){return h.each(function(){e(this).draggable({disabled:false})})},disable:function(h){return h.each(function(){e(this).draggable({disabled:true})})}};e.fn.draggable.parseOptions=function(h){var i=e(h);return e.extend({},e.parser.parseOptions(h,["cursor","handle","axis",{revert:"boolean",deltaX:"number",deltaY:"number",edge:"number",delay:"number"}]),{disabled:(i.attr("disabled")?true:undefined)})};e.fn.draggable.defaults={proxy:null,revert:false,cursor:"move",deltaX:null,deltaY:null,handle:null,disabled:false,edge:0,axis:null,delay:100,onBeforeDrag:function(h){},onStartDrag:function(h){},onDrag:function(h){},onEndDrag:function(h){},onStopDrag:function(h){}};e.fn.draggable.isDragging=false})(jQuery);