(function(e){function f(j){var i=e.data(j,"passwordbox");var h=i.options;var g=e.extend(true,[],h.icons);if(h.showEye){g.push({iconCls:"passwordbox-open",handler:function(k){h.revealed=!h.revealed;c(j)}})}e(j).addClass("passwordbox-f").textbox(e.extend({},h,{icons:g}));c(j)}function b(k,j,p){var r=e(k);var o=r.passwordbox("options");if(o.revealed){r.textbox("setValue",j);return}var m=unescape(o.passwordChar);var g=j.split("");var q=r.passwordbox("getValue").split("");for(var h=0;h<g.length;h++){var n=g[h];if(n!=q[h]){if(n!=m){q.splice(h,0,n)}}}var l=r.passwordbox("getSelectionStart");if(g.length<q.length){q.splice(l,q.length-g.length,"")}for(var h=0;h<g.length;h++){if(p||h!=l-1){g[h]=m}}r.textbox("setValue",q.join(""));r.textbox("setText",g.join(""));r.textbox("setSelectionRange",{start:l,end:l})}function c(g,l){var h=e(g);var k=h.passwordbox("options");var j=h.next().find(".passwordbox-open");var i=unescape(k.passwordChar);l=l==undefined?h.textbox("getValue"):l;h.textbox("setValue",l);h.textbox("setText",k.revealed?l:l.replace(/./ig,i));k.revealed?j.addClass("passwordbox-close"):j.removeClass("passwordbox-close")}function d(k){var j=k.data.target;var h=e(k.data.target);var i=h.data("passwordbox");var g=h.data("passwordbox").options;i.checking=true;i.value=h.passwordbox("getText");(function(){if(i.checking){var l=h.passwordbox("getText");if(i.value!=l){i.value=l;if(i.lastTimer){clearTimeout(i.lastTimer);i.lastTimer=undefined}b(j,l);i.lastTimer=setTimeout(function(){b(j,h.passwordbox("getText"),true);i.lastTimer=undefined},g.lastDelay)}setTimeout(arguments.callee,g.checkInterval)}})()}function a(i){var g=i.data.target;var h=e(g).data("passwordbox");h.checking=false;if(h.lastTimer){clearTimeout(h.lastTimer);h.lastTimer=undefined}c(g)}e.fn.passwordbox=function(i,h){if(typeof i=="string"){var g=e.fn.passwordbox.methods[i];if(g){return g(this,h)}else{return this.textbox(i,h)}}i=i||{};return this.each(function(){var j=e.data(this,"passwordbox");if(j){e.extend(j.options,i)}else{j=e.data(this,"passwordbox",{options:e.extend({},e.fn.passwordbox.defaults,e.fn.passwordbox.parseOptions(this),i)})}f(this)})};e.fn.passwordbox.methods={options:function(g){return e.data(g[0],"passwordbox").options},setValue:function(h,g){return h.each(function(){c(this,g)})},clear:function(g){return g.each(function(){c(this,"")})},reset:function(g){return g.each(function(){e(this).textbox("reset");c(this)})},showPassword:function(g){return g.each(function(){var h=e(this).passwordbox("options");h.revealed=true;c(this)})},hidePassword:function(g){return g.each(function(){var h=e(this).passwordbox("options");h.revealed=false;c(this)})}};e.fn.passwordbox.parseOptions=function(g){return e.extend({},e.fn.textbox.parseOptions(g),e.parser.parseOptions(g,["passwordChar",{checkInterval:"number",lastDelay:"number",revealed:"boolean",showEye:"boolean"}]))};e.fn.passwordbox.defaults=e.extend({},e.fn.textbox.defaults,{passwordChar:"%u25CF",checkInterval:200,lastDelay:500,revealed:false,showEye:true,inputEvents:{focus:d,blur:a},val:function(g){return e(g).parent().prev().passwordbox("getValue")}})})(jQuery);